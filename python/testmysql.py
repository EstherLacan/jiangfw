# -*- coding: UTF-8 -*-

from my_sql_conn import DbFunctions

"""
权限：66
预置权限表数据
"""



# white_list = '''00200159,00198833,00427968,00322980,00286681,00163986,00381457,00419126,00432214,00217547,00325618,00399376,00353718,00206292,00333620,00337478,00368500,00257368,00228276,00258350,00325275,00333181,00166347,00294910,00197513,00334382,00374827,00164687,00326217,00179110,00380775,00275807,00257191,00218850,00267203,00246462,00415108,00311989,00380820,00381183,00398296,00310372,00172074,00355508,WX393719,WX424823,00380205,WX520282,00408731,90006420,90005469,00431545,00316418,00406756,00399964,00411304,00402864,00395853,00417604,00365899,00200832,00192245,00368345,00276989,00304890,00184171,00417023,00282176,00307761,00405167,00186403,00401577,00215010,00416325,00183740,00183691,00301133,00330601,00322980,00325618,00337061,00257368,00247527,00217547,00337478,00378770,00231747,00239202,00365987,00292048,00302442,00759290,00390675,00346654,00226181,00400209,00391939,00435442,00350091,00390132,00275600,00318840,WX437165,00266674,00231439,00334042,00227695,00383937,00209709,00287048,00412651,00199755,90005783,00327240,00285037,00216300,00278668,00400209,00350091,00327728,00400261,00302461,00412313,00335632,00414266,00302786,00221460,00227786,00302442,00278155,WX426749,00257691,00226003,00257029,00406777,00406770,00283074,00355482,00164900,00245737,00204820,00176510,00248489,00413452,00422977,00193100,00417448,00341563,WX293926,WX289667,WX483311,WX290147,WX513133,00370778,WX490762,00367363,00424953,00180500,00170869,00354138,00318926,00333136,00214929,00285037,00417774,WX535602,WX455197,WX455486,WX455196,WX507731,WX195676,84087156,00301042,00215080,00345323,00418051,00273940,00419385,00340843,00222768,00255955,00258408,00398656,00234213,00167922,00383385,00303542,00371309,00371309,00239302,00333136,00330634,00303542,00167922,00403879,00401555,00257240,00231700,00198223,00293454,00286909,WX508006,00288206,00361794,00299943,00428680,WX499484,WX440483,WX505994,WX453456,WX439150,WX520787,00179930,00354138,00318926,WX421924,WX427884,WX423857,00367323,00278145,00317293,00247249,00190916,00293255,00421853,00196888,00274895,00294266,00434340,00188802,00425455,00257020,00247259,00300652,00335548,00413479,00312049,00350880,00417578,00425664,00246472,00196064,00191901,00368995,00191500,00210370,00238417,00419044,00175027,00246457,00426356,00250793,00358866,00206730,00440865,00183347,00398556,00224265,00324741,00334901,00319192,00169189,00362325,00226008,00371057,00178921,00387732,00380673,WX542257,00434706,00736811,00431808,00299147,00220366,00389469,00274417,00187434,00257485,00435444,00238375,00232158,00413388,00201157,00214709,00227949,00375156,00179879,00354662,00411304,00441334,00381816,00175667,00221261,00226791,00215913,00303625,00229235,00273746,00216824,00282815,00233463,00220457,WX494023,WX494024,00424475,00220019,00296177,00341688,00417448,00381918,00382132,00367762,00423579,WX494020,00272599,00247458,00290721,00327018,00379525,00337478,WX404959,00285625,00359505,00419151,00419128,00287488,00413070,00238421,00192149,00210184,00251403,00379108,00202355,00198406,00387186,00249927,00239175,00176129,00219973,00397162,00183200,00359921,00209896,00352164,00190504,WX457897,00374533,00412904,90005854,00212902,WX465009,00241654,00369825,00401341,00405812,WX512424,WX516029,00383330,00351226,00389476,00265742,00246224,00342050,00231634,00286046,00164377,00236261,00227824,00418794,00338910'''
# white_list = 'WX464539,WX511437,WX511438,WX512248'
white_list = 'sysadmin'
white_list_array = white_list.split(",")
white_list_array = sorted(set(white_list_array), key=white_list_array.index)  # 去重
print(white_list_array)
print 'white_list_array size is ' + str(len(white_list_array))
tiyangailan = 'ubatiyangailan'


def initTiyanGaiLan():
    """
    预置体验概览权限
    """
    tiyan_rows = []
    for white_user in white_list_array:
        tiyan_row = []
        tiyan_row.append(white_user)
        tiyan_row.append(tiyangailan)
        tiyan_row.append(20180320000000)
        tiyan_rows.append(tiyan_row)
    insertPermissionList(tiyan_rows)
    print 2


def initAllAppKey():
    """
    预置所有appkey权限
    """
    appkeys = queryAppKey()
    appkey_list = []
    for white_user in white_list_array:
        for appkey in appkeys:
            appkey_row = []
            appkey_row.append(white_user)
            appkey_row.append(appkey[0])
            appkey_row.append("20180320000000")
            appkey_list.append(appkey_row)
    insertPermissionList(appkey_list)
    print 3


def queryAppKey():
    """
    查询appkey
    """
    db = DbFunctions("100.109.35.184", "root", "Wad_1234!", "uba_db")
    result = db.mysql_qry("select appkey from t_uba_app", 1)
    appkey_list = []
    for app_key in result:
        if app_key not in appkey_list:
            appkey_list.append(app_key)
    print(appkey_list)
    print 'result size is ' + str(len(appkey_list))
    return appkey_list


def insertPermissionList(rows):
    """
    插入权限
    """
    db = DbFunctions("100.109.35.184", "root", "Wad_1234!", "uba_db")
    db.insert_by_many('t_uba_permission_list', rows)
    # print(result)


if __name__ == '__main__':
    initTiyanGaiLan()
    initAllAppKey()
